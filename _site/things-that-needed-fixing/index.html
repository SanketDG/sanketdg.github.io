<!DOCTYPE html>
<html>
    <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Things that needed fixing. - SanketDG</title>
    <meta name="description" content="This week I am going to talk about the things that I have been working on,mainly on PR #2423. This is the second last week of GSoC and I fixed alot of quirks...">

    <link href='https://fonts.googleapis.com/css?family=Roboto+Mono|Roboto:300,400,900,400italic' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/css/main.css">
    <link rel="canonical" href="http://localhost:4000/things-that-needed-fixing/">
    <link rel="alternate" type="application/rss+xml" title="SanketDG" href="http://localhost:4000/feed.xml">
<script src="http://127.0.0.1:35729/livereload.js"></script></head>

    <body>
        <main class="u-container">
        <div class="c-page">
    <header class="c-page__header">
    <h1>SanketDG</h1>


    <p>
        <a href="/">Home</a><span
          class="u-separate"></span> <a href="/projects/">Projects</a><span class="u-separate"></span> <a href="/about/">About</a><span class="u-separate"></span><a href="/feed.xml">RSS</a>
    </p>
</header>

    <div class="c-page__main">
    <article class="c-article">
    <header class="c-article__header">
        <h1 class="c-article__title">Things that needed fixing.</h1>
        <p class="c-article__time"><time datetime="2016-08-08T23:00:00+05:30" itemprop="datePublished">Aug 8, 2016</time></p>
    </header>

    <!-- Post Tags -->
    <ul class="c-tags">
    
      <li class="c-tag">gsoc</li>
    
      <li class="c-tag">documentation</li>
    
    </ul>

    <div class="c-article__main">
        <p>This week I am going to talk about the things that I have been working on,
mainly on <a href="https://github.com/coala-analyzer/coala/pull/2423">PR #2423</a>. This is the second last week of GSoC and I fixed a
lot of quirks that I was facing for the first two weeks.</p>

<p>The first one deals with opinionated documentation styles. Most projects
follow this style of documentation:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>:param x:           blablabla
:param muchtoolong: blablabla
</code></pre>
</div>

<p>While this format is used in most projects, it requires a lot of maintainance (and patience). One extra line or a few extra words and you have to literally “re-design” the entire documentation comment. But there’s another life-saving
style though.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>:param x:
    blablabla
:param muchtoolong:
    blablabla
</code></pre>
</div>

<p>When I was writing the parsing algorithm for extracting documentation metadata,
I had completely forgotten about this style, and thus when I took the algorithm for
a test drive, it indeed failed. The bug and the solution were both simple. The
algorithm expects a space after the metadata symbols, which wouldn’t ideally
happen in the second style. Thus, <a href="https://github.com/coala-analyzer/coala/pull/2423/commits/6eb9ee0354371662bc2fba2fcead7cbec8cf20a6">removing</a> the space clearly solves the problem and
parses everything correctly. This affects parsing of the first style in a small way,
where we now have to account for an extra space.</p>

<p><strong>In the future</strong>: I am hoping to improve this, the current process of
searching for strings is not the most effecient way, I am thinking of
slowly transitioning to regex for this.</p>

<p>Another tiny bug that I found was in the documentation extraction algorithms that were
already implemented by my mentor <a href="https://github.com/Makman2">@Makman2</a>.</p>

<p>To talk about this, I need to explain what a documentation marker means in my project.
Its basically a 3-element tuple of strings that define how a documentation comment starts,
continues and ends.</p>

<p>So for a python docstring it would look something like <code class="highlighter-rouge">('"""', '', '"""')</code>.
For javadoc, it would look like <code class="highlighter-rouge">('/**', ' *', ' */')</code></p>

<p>Now the bug was that for documentation comments that were identified with no middle marker
i.e. <code class="highlighter-rouge">marker[1] = ''</code>, it was completely ignoring lines that only contained a <code class="highlighter-rouge">\n</code> i.e.
an empty line. This would lead to wrong parsing. The <a href="https://github.com/coala-analyzer/coala/pull/2423/commits/edf9f3e443fd4f758ecb80a48318237fd7723fae">solution</a>  (for now) was a simple
if-statement to insert a newline if it found a empty line.</p>

<p>Also, I <a href="https://github.com/coala-analyzer/coala/pull/2423/commits/a3c5187bf4943480938c7169fe575d70d8ec65c2">fixed</a> Escaping. Although I am still not sure that the solution is bulletproof and
would work for all cases, it’s good enough. Also, turns out that I have been doing the
setting extraction wrong, getting the escaped value (and not the unescaped one).</p>

<p>Also, I removed some code! As a developer, it feels great to remove more and more lines of code
that you don’t need. First, I <a href="https://github.com/coala-analyzer/coala/pull/2423/commits/edf9f3e443fd4f758ecb80a48318237fd7723fae">removed</a> a relatively useless exception handling in the
parsing algorithm.</p>

<p>Second, I <a href="https://github.com/coala-analyzer/coala/pull/2423/commits/99be48f18a88bb24d79b39d1e056295d725a55af">moved</a> one of the functions that loaded a file and returned its lines as a list.
It was being used in the testing classes. It was being used in three separate files,
and thus was moved to a new file <code class="highlighter-rouge">TestUtils.py</code>, from where it was then used.
<strong>REFACTOR EVERYTHING!!!</strong></p>

<p>Lastly, now <code class="highlighter-rouge">DocumentationComment</code> <a href="https://github.com/coala-analyzer/coala/pull/2423/commits/19b36f847c6e2f6edaa1d7eec9ede44db31c6178">requires</a> a <code class="highlighter-rouge">DocstyleDefinition</code> object, instead of
language and docstyle (which I always thought was redundant). This kind of falls in refactoring,
and thus more removing!</p>

<p>Coming to things that were added, I finalized the design of the assembling functions,
with the help of my mentor. So we decided on having two functions. One constructor-like <a href="https://github.com/coala-analyzer/coala/pull/2423/commits/1f2c93510552948c4ac9301303751fb1255fd498">function</a>
that would just arrange the documentation text from the parsed documentation metadata. So it
wouldn’t be responsible for the markers and indentation. It returns a <code class="highlighter-rouge">DocumentationComment</code>
object that contains all the required things for the final assembling. This function could
sometimes act like a constructor, where it takes parsed metadata and spits out a readymade
DocumentationComment object ready for use.</p>

<p>The final assembling function just <a href="https://github.com/coala-analyzer/coala/pull/2423/commits/cdc885c0a8ed682a3c47ff743eefba5edcde4123">assembles</a> the documentation taking into account the markers
and indentation. It returns the assembled documentation comment as a string that can be
added/updated in files. While developing this, I actually found out that my algorithm for
doing this was totally buggy and would not work for a lot of corner cases, so I am in the
process of working them out.</p>

<p>Also, on a side note, I <a href="https://github.com/coala-analyzer/coala/pull/2423/commits/37b58ec79cec702e1b2c40ecfda30181a53118d3">figured</a> out the metadata settings. This is important, because its
important to implement some variable functionality as settings, because it imparts freedom
to the user to define what they want to parse. Right now, the concept is at its infancy,
for example, settings for a conventional python docstring would like:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>param_start = :param\ # here's a space
param_end = :
return_sep = :return:
</code></pre>
</div>

<p>That’s all for this blog post, I guess. I am almost done with the work
in the core repo. I can finally start developing some cool bears!</p>


    </div>

    <!-- Previous / Next Buttons -->
    <div class="pagenav">
		
        <div class="wrapper" id="left">
          <small><b>Previous</b> Jul 24, 2016</small>
          <br>
          <a href="/config-related-problems/">&laquo; Escaping!</a>
        </div>
		
		
        <div class="wrapper" id="right">
          <small>Aug 21, 2016 <b>Next</b></small>
          <br>
          <a href="/config-related-problems/">That's it, folks! &raquo;</a>
        </div>
		
		</div>

		<!-- Disqus comments view -->
		
		<div class="post-disqus">
				<section id="disqus_thread"></section>
				<script>

/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables */

var disqus_config = function () {
  this.page.url = /things-that-needed-fixing/;  // Replace PAGE_URL with your page's canonical URL variable
  this.page.identifier = /things-that-needed-fixing; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'https://sanketdg.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

		</div>
		
</article>

    </div>
    <footer class="c-page__footer">
    <p>&copy; SanketDG 2017</p>
    <p><a href="https://twitter.com/SanketDG">Twitter</a><span class="u-separate"></span><a href="https://github.com/SanketDG">Github</a></p>
</footer>

</div>

        </main>
    
    </body>
</html>
